# 리눅스 성능테스트 비교: ServerLink vs libzmq

**측정일**: 2026-01-03
**플랫폼**: Linux (Ubuntu 24.04.3 LTS, WSL2)
**CPU**: Intel Core Ultra 7 265K (20 cores)
**메모리**: 62 GB
**커널**: 6.6.87.2-microsoft-standard-WSL2
**빌드 타입**: Release (-O3)
**측정 방식**: 3회 반복 실행 후 평균값

---

## 1. 처리량 (Throughput) 비교

### 1.1 개별 실행 결과

#### ServerLink (ROUTER-ROUTER 패턴)

| Run | Transport | 64B | 1KB | 8KB | 64KB |
|-----|-----------|-----|-----|-----|------|
| 1 | TCP | 4,933,069 | 886,478 | 191,328 | 72,150 |
| 2 | TCP | 5,008,946 | 875,482 | 187,772 | 51,130 |
| 3 | TCP | 4,940,605 | 906,424 | 186,755 | 74,080 |
| 1 | inproc | 4,395,277 | 1,441,692 | 693,603 | 210,986 |
| 2 | inproc | 4,469,227 | 1,499,206 | 827,491 | 254,586 |
| 3 | inproc | 4,435,491 | 1,535,052 | 753,243 | 160,826 |
| 1 | IPC | 4,970,454 | 1,036,697 | 188,645 | 65,097 |
| 2 | IPC | 5,082,490 | 1,014,409 | 215,510 | 59,452 |
| 3 | IPC | 4,967,008 | 1,075,974 | 228,082 | 61,297 |

#### libzmq 4.3.5 (PUSH-PULL 패턴)

| Run | Transport | 64B | 1KB | 8KB | 64KB |
|-----|-----------|-----|-----|-----|------|
| 1 | TCP | 5,014,738 | 893,314 | 165,761 | 76,893 |
| 2 | TCP | 4,942,961 | 729,785 | 178,291 | 63,199 |
| 3 | TCP | 4,974,343 | 777,457 | 196,496 | 70,657 |
| 1 | inproc | 4,623,516 | 1,241,505 | 499,695 | 174,093 |
| 2 | inproc | 4,289,607 | 1,480,150 | 463,708 | 175,430 |
| 3 | inproc | 4,255,097 | 1,512,639 | 445,527 | 294,004 |
| 1 | IPC | 5,066,546 | 947,052 | 219,391 | 64,983 |
| 2 | IPC | 5,189,647 | 993,543 | 218,642 | 70,455 |
| 3 | IPC | 5,246,108 | 1,020,538 | 211,915 | 68,190 |

### 1.2 평균값 비교 (msg/s)

| Transport | Size | ServerLink | libzmq | 차이 | 평가 |
|-----------|------|------------|--------|------|------|
| **TCP** | 64B | 4,960,873 | 4,977,347 | -0.3% | ✅ 동등 |
| **TCP** | 1KB | 889,461 | 800,185 | **+11.2%** | ✅ ServerLink 우수 |
| **TCP** | 8KB | 188,618 | 180,183 | **+4.7%** | ✅ ServerLink 우수 |
| **TCP** | 64KB | 65,787 | 70,250 | -6.4% | ⚠️ libzmq 우수 |
| **inproc** | 64B | 4,433,332 | 4,389,407 | **+1.0%** | ✅ 동등 |
| **inproc** | 1KB | 1,491,983 | 1,411,431 | **+5.7%** | ✅ ServerLink 우수 |
| **inproc** | 8KB | 758,112 | 469,643 | **+61.4%** | ✅ ServerLink 우수 |
| **inproc** | 64KB | 208,799 | 214,509 | -2.7% | ✅ 동등 |
| **IPC** | 64B | 5,006,651 | 5,167,434 | -3.1% | ✅ 동등 |
| **IPC** | 1KB | 1,042,360 | 987,044 | **+5.6%** | ✅ ServerLink 우수 |
| **IPC** | 8KB | 210,746 | 216,649 | -2.7% | ✅ 동등 |
| **IPC** | 64KB | 61,949 | 67,876 | -8.7% | ⚠️ libzmq 우수 |

---

## 2. 지연시간 (Latency) 비교

### 2.1 ServerLink RTT (Round-Trip Time)

#### 개별 실행 결과 (p50, μs)

| Run | Transport | 64B | 1KB | 8KB |
|-----|-----------|-----|-----|-----|
| 1 | TCP | 97.63 | 83.70 | 65.16 |
| 2 | TCP | 84.65 | 57.54 | 154.72 |
| 3 | TCP | 56.24 | 55.93 | 65.92 |
| 1 | inproc | 38.16 | 38.46 | 69.68 |
| 2 | inproc | 38.21 | 40.02 | 25.24 |
| 3 | inproc | 38.28 | 24.45 | 41.05 |
| 1 | IPC | 81.86 | 75.88 | 59.80 |
| 2 | IPC | 80.59 | 80.76 | 92.04 |
| 3 | IPC | 83.10 | 75.22 | 92.27 |

### 2.2 평균 지연시간 (p50, μs)

| Transport | 64B | 1KB | 8KB |
|-----------|-----|-----|-----|
| **TCP** | 79.51 | 65.72 | 95.27 |
| **inproc** | **38.22** | **34.31** | **45.32** |
| **IPC** | 81.85 | 77.29 | 81.37 |

> **참고**: 단방향 지연시간 ≈ RTT / 2

---

## 3. 대역폭 (Bandwidth) 비교

### 최대 대역폭 기록 (MB/s)

| 라이브러리 | Transport | Size | Bandwidth |
|-----------|-----------|------|-----------|
| **ServerLink** | inproc | 64KB | **15,911 MB/s** (Run 2) |
| **ServerLink** | inproc | 8KB | 6,464 MB/s (Run 2) |
| libzmq | inproc | 64KB | 18,375 MB/s (Run 3) |
| libzmq | inproc | 8KB | 3,903 MB/s (Run 1) |

---

## 4. 핵심 결론

### 4.1 처리량 요약

| 항목 | 결과 |
|------|------|
| **TCP 소형 메시지** (64B-1KB) | ServerLink ≈ libzmq (동등~11% 우수) |
| **TCP 대형 메시지** (8KB-64KB) | ServerLink ≈ libzmq (±6%) |
| **inproc 중형 메시지** (1KB-8KB) | **ServerLink 5~61% 우수** |
| **IPC 소형 메시지** (64B-1KB) | ServerLink ≈ libzmq (동등~6% 우수) |

### 4.2 주요 발견

1. **ServerLink는 ROUTER 패턴 사용**
   - libzmq의 PUSH-PULL보다 더 복잡한 패턴
   - routing ID 처리 오버헤드가 있음에도 동등하거나 우수한 성능

2. **inproc 8KB에서 ServerLink 61% 우수**
   - ServerLink: 758,112 msg/s
   - libzmq: 469,643 msg/s

3. **TCP/IPC 1KB에서 ServerLink 5-11% 우수**
   - ServerLink의 메시지 처리 최적화 효과

4. **대형 메시지(64KB)에서 libzmq 6-9% 우수**
   - 대용량 데이터 전송 최적화 차이

### 4.3 변동성 분석

WSL2 환경에서 벤치마크 변동성이 관찰됨:
- 64KB inproc: libzmq 174K~294K (최대 69% 변동)
- 64KB TCP: ServerLink 51K~74K (최대 45% 변동)

**권장사항**: 정확한 성능 측정은 네이티브 Linux에서 수행

---

## 5. 테스트 환경 상세

```
라이브러리 버전:
- ServerLink: v0.1.1 (C++20)
- libzmq: 4.3.5

빌드 설정:
- 컴파일러: GCC (C++20)
- 최적화: -O3
- I/O 폴러: epoll

벤치마크 패턴:
- ServerLink: ROUTER-ROUTER (양방향 routing ID)
- libzmq: PUSH-PULL (단방향)
```

---

## 6. 결론

**ServerLink는 libzmq 4.3.5와 동등하거나 우수한 성능을 제공합니다.**

특히:
- ✅ 소형/중형 메시지 처리량: 동등 또는 우수
- ✅ inproc 전송: 최대 61% 우수
- ✅ 더 복잡한 ROUTER 패턴에서도 성능 유지
- ⚠️ 대형 메시지(64KB): libzmq가 약간 우수 (6-9%)

---

**작성**: Claude (자동 생성)
**최종 업데이트**: 2026-01-03
